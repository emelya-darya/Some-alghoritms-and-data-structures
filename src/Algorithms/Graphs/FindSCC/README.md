Компонентами сильной связности в ориентированном графе называют подмножество вершин в каждом из которых от любой вершины по ориентированным ребрам можно добраться до любой другой

Самый первый  DFS безопасно запустить от любой вершины, КСС которой является в графе конденсации стоком

всегда верно, что первая вершина в топологической сортировке принадлежит КСС-истоку

Построим вспомогательный граф, в котором направление всех ребер изменено на противоположное.
Первая вершина в топологической сортировке этого графа всегда принадлежит КСС-стоку в исходном графе


Алгоритм:
1. Построить вспомогательный граф, в котором направление всех ребер изменено на противоположное
2. Запустить на вспомогательном графе топологическую сортировку
3. Раскрасить исходный граф, запуская DFS в порядке топологической сортировки



https://www.youtube.com/watch?v=-UgiBh1IMQU